(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     27058,        736]
NotebookOptionsPosition[     26438,        711]
NotebookOutlinePosition[     26807,        727]
CellTagsIndexPosition[     26764,        724]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.711388047802121*^9, 3.711388049190546*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Epsilon]", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "5"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Omega]", ",", "l", ",", "r\[Infinity]", ",", "r0", ",", "R\[Infinity]",
      ",", "Rp\[Infinity]", ",", "\[Nu]", ",", "\[Mu]1", ",", "s", ",", 
     "\[Mu]2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Omega]", "=", 
     FractionBox["2", "5"]}], ";", 
    RowBox[{"l", "=", "0"}], ";", 
    RowBox[{"s", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"r\[Infinity]", "=", "20"}], ";", 
    RowBox[{"r0", "=", 
     RowBox[{"1", "+", "\[Epsilon]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Nu]", "=", "0"}], ";", 
    RowBox[{"\[Mu]1", "=", "0"}], ";", 
    RowBox[{"\[Mu]2", "=", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"s", "+", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"R\[Infinity]", "=", 
     FractionBox[
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], " ", "\[Omega]", " ", 
        RowBox[{"(", 
         RowBox[{"r\[Infinity]", "+", 
          RowBox[{"Log", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "r\[Infinity]"}], "]"}]}], ")"}]}], 
       "]"}], "r\[Infinity]"]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Rp\[Infinity]", "=", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Omega]", " ", 
         RowBox[{"(", 
          RowBox[{"r\[Infinity]", "+", 
           RowBox[{"Log", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "r\[Infinity]"}], "]"}]}], ")"}]}]], 
       " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"r\[Infinity]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "-", 
            RowBox[{"\[ImaginaryI]", " ", "r\[Infinity]", " ", "\[Omega]"}]}],
            ")"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "r\[Infinity]"}], ")"}], " ", 
       SuperscriptBox["r\[Infinity]", "2"]}]]}], ";", "\[IndentingNewLine]", 
    RowBox[{"solIn", "=", 
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"R", "''"}], "[", "r", "]"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              FractionBox["1", "r"], "+", 
              FractionBox["1", 
               RowBox[{"r", "-", "1"}]]}], ")"}], 
            RowBox[{
             RowBox[{"R", "'"}], "[", "r", "]"}]}], "+", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["\[Omega]", "2"]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"r", "-", "1"}], ")"}], "l", " ", 
               RowBox[{"(", 
                RowBox[{"l", "+", "1"}], ")"}]}]}], 
             RowBox[{"r", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"r", "-", "1"}], ")"}], "2"]}]], 
            RowBox[{"R", "[", "r", "]"}]}]}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"R", "[", "r\[Infinity]", "]"}], "\[Equal]", 
          "R\[Infinity]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"R", "'"}], "[", "r\[Infinity]", "]"}], "\[Equal]", 
          "Rp\[Infinity]"}]}], "}"}], ",", "R", ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", "r0", ",", "r\[Infinity]"}], "}"}], ",", 
       RowBox[{"WorkingPrecision", "\[Rule]", "30"}], ",", 
       RowBox[{"AccuracyGoal", "\[Rule]", "30"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"p1", "=", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Re", "[", 
            RowBox[{"R", "[", "r", "]"}], "]"}], ",", 
           RowBox[{"Im", "[", 
            RowBox[{"R", "[", "r", "]"}], "]"}]}], "}"}], "/.", "solIn"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", "r0", ",", "r\[Infinity]"}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Blue", ",", "Dashed"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Red", ",", "Dashed"}], "}"}]}], "}"}]}]}], "]"}]}], 
    ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Omega]", ",", "l", ",", "r\[Infinity]", ",", "r0", ",", "R\[Infinity]",
      ",", "Rp\[Infinity]", ",", "\[Nu]", ",", "\[Mu]1", ",", "s", ",", 
     "\[Mu]2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Omega]", "=", 
     FractionBox["2", "5"]}], ";", 
    RowBox[{"l", "=", "0"}], ";", 
    RowBox[{"s", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"r\[Infinity]", "=", "20"}], ";", 
    RowBox[{"r0", "=", 
     RowBox[{"1", "+", "\[Epsilon]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Nu]", "=", "0"}], ";", 
    RowBox[{"\[Mu]1", "=", "0"}], ";", 
    RowBox[{"\[Mu]2", "=", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"s", "+", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"R\[Infinity]", "=", 
     FractionBox[
      RowBox[{"Exp", "[", 
       RowBox[{"I", " ", "\[Omega]", " ", 
        RowBox[{"(", 
         RowBox[{"r\[Infinity]", "+", 
          RowBox[{"Log", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "r\[Infinity]"}], "]"}]}], ")"}]}], 
       "]"}], "r\[Infinity]"]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Rp\[Infinity]", "=", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[Omega]", " ", 
         RowBox[{"(", 
          RowBox[{"r\[Infinity]", "+", 
           RowBox[{"Log", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "r\[Infinity]"}], "]"}]}], ")"}]}]], 
       " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"r\[Infinity]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"\[ImaginaryI]", " ", "r\[Infinity]", " ", "\[Omega]"}]}],
            ")"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "r\[Infinity]"}], ")"}], " ", 
       SuperscriptBox["r\[Infinity]", "2"]}]]}], ";", "\[IndentingNewLine]", 
    RowBox[{"solOut", "=", 
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"R", "''"}], "[", "r", "]"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              FractionBox["1", "r"], "+", 
              FractionBox["1", 
               RowBox[{"r", "-", "1"}]]}], ")"}], 
            RowBox[{
             RowBox[{"R", "'"}], "[", "r", "]"}]}], "+", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["\[Omega]", "2"]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"r", "-", "1"}], ")"}], "l", " ", 
               RowBox[{"(", 
                RowBox[{"l", "+", "1"}], ")"}]}]}], 
             RowBox[{"r", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"r", "-", "1"}], ")"}], "2"]}]], 
            RowBox[{"R", "[", "r", "]"}]}]}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"R", "[", "r\[Infinity]", "]"}], "\[Equal]", 
          "R\[Infinity]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"R", "'"}], "[", "r\[Infinity]", "]"}], "\[Equal]", 
          "Rp\[Infinity]"}]}], "}"}], ",", "R", ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", "r0", ",", "r\[Infinity]"}], "}"}], ",", 
       RowBox[{"WorkingPrecision", "\[Rule]", "30"}], ",", 
       RowBox[{"AccuracyGoal", "\[Rule]", "30"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"p2", "=", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Re", "[", 
            RowBox[{"R", "[", "r", "]"}], "]"}], ",", 
           RowBox[{"Im", "[", 
            RowBox[{"R", "[", "r", "]"}], "]"}]}], "}"}], "/.", "solOut"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", "r0", ",", "r\[Infinity]"}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Blue", ",", "Dotted"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Red", ",", "Dotted"}], "}"}]}], "}"}]}]}], "]"}]}], 
    ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Omega]", ",", "l", ",", "r\[Infinity]", ",", "r0", ",", "R0", ",", 
     "Rp0", ",", "\[Nu]", ",", "\[Mu]1", ",", "s", ",", "\[Mu]2"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Omega]", "=", 
     FractionBox["2", "5"]}], ";", 
    RowBox[{"l", "=", "0"}], ";", 
    RowBox[{"s", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"r\[Infinity]", "=", "20"}], ";", 
    RowBox[{"r0", "=", 
     RowBox[{"1", "+", "\[Epsilon]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Nu]", "=", "0"}], ";", 
    RowBox[{"\[Mu]1", "=", "0"}], ";", 
    RowBox[{"\[Mu]2", "=", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"s", "+", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"R0", "=", 
     FractionBox[
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], " ", "\[Omega]", " ", 
        RowBox[{"(", 
         RowBox[{"r0", "+", 
          RowBox[{"Log", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "r0"}], "]"}]}], ")"}]}], "]"}], "r0"]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"Rp0", "=", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Omega]", " ", 
         RowBox[{"(", 
          RowBox[{"r0", "+", 
           RowBox[{"Log", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "r0"}], "]"}]}], ")"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"r0", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "-", 
            RowBox[{"\[ImaginaryI]", " ", "r0", " ", "\[Omega]"}]}], 
           ")"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "r0"}], ")"}], " ", 
       SuperscriptBox["r0", "2"]}]]}], ";", "\[IndentingNewLine]", 
    RowBox[{"solCausal", "=", 
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"R", "''"}], "[", "r", "]"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              FractionBox["1", "r"], "+", 
              FractionBox["1", 
               RowBox[{"r", "-", "1"}]]}], ")"}], 
            RowBox[{
             RowBox[{"R", "'"}], "[", "r", "]"}]}], "+", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["\[Omega]", "2"]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"r", "-", "1"}], ")"}], "l", " ", 
               RowBox[{"(", 
                RowBox[{"l", "+", "1"}], ")"}]}]}], 
             RowBox[{"r", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"r", "-", "1"}], ")"}], "2"]}]], 
            RowBox[{"R", "[", "r", "]"}]}]}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"R", "[", "r0", "]"}], "\[Equal]", "R0"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"R", "'"}], "[", "r0", "]"}], "\[Equal]", "Rp0"}]}], "}"}],
        ",", "R", ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", "r0", ",", "r\[Infinity]"}], "}"}], ",", 
       RowBox[{"WorkingPrecision", "\[Rule]", "30"}], ",", 
       RowBox[{"AccuracyGoal", "\[Rule]", "30"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"p3", "=", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Re", "[", 
            RowBox[{"R", "[", "r", "]"}], "]"}], ",", 
           RowBox[{"Im", "[", 
            RowBox[{"R", "[", "r", "]"}], "]"}]}], "}"}], "/.", "solCausal"}],
         "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", "r0", ",", "r\[Infinity]"}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "Blue", "}"}], ",", 
          RowBox[{"{", "Red", "}"}]}], "}"}]}]}], "]"}]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RIn", "[", "r_", "]"}], ":=", 
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"R", "[", "r", "]"}], "/.", "solIn"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ROut", "[", "r_", "]"}], ":=", 
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"R", "[", "r", "]"}], "/.", "solOut"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RCausal", "[", "r_", "]"}], ":=", 
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"R", "[", "r", "]"}], "/.", "solCausal"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Show", "[", 
   RowBox[{"p1", ",", "p2", ",", "p3", ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rpts", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"r", ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", "10", ",", "20", ",", 
       FractionBox["1", "2"]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rpts", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"RCausal", "[", "#", "]"}], "&"}], "/@", "rpts"}], "//", 
    "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rpts", ",", "Rpts"}], "}"}], "//", "Transpose"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"model", "=", 
   RowBox[{
    RowBox[{"AIn", " ", 
     RowBox[{"RIn", "[", "r", "]"}]}], "+", 
    RowBox[{"AOut", " ", 
     RowBox[{"ROut", "[", "r", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"fit", "=", 
  RowBox[{"FindFit", "[", 
   RowBox[{"data", ",", "model", ",", 
    RowBox[{"{", 
     RowBox[{"AIn", ",", "AOut"}], "}"}], ",", "r"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modelf", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", "r", "}"}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"model", "/.", "fit"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"RIn", "[", "r0", "]"}], ",", 
     RowBox[{"ROut", "[", "r0", "]"}], ",", 
     RowBox[{"RCausal", "[", "r0", "]"}]}], "}"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r0", "\[Rule]", 
      RowBox[{"1", "+", "\[Epsilon]"}]}], ",", 
     RowBox[{"r\[Infinity]", "\[Rule]", "20"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"RIn", "[", "r\[Infinity]", "]"}], ",", 
     RowBox[{"ROut", "[", "r\[Infinity]", "]"}], ",", 
     RowBox[{"RCausal", "[", "r\[Infinity]", "]"}], ",", 
     RowBox[{
      RowBox[{"RIn", "'"}], "[", "r\[Infinity]", "]"}], ",", 
     RowBox[{
      RowBox[{"ROut", "'"}], "[", "r\[Infinity]", "]"}], ",", 
     RowBox[{
      RowBox[{"RCausal", "'"}], "[", "r\[Infinity]", "]"}]}], "}"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r0", "\[Rule]", 
      RowBox[{"1", "+", "\[Epsilon]"}]}], ",", 
     RowBox[{"r\[Infinity]", "\[Rule]", "20"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Rc\[Infinity]", "\[Equal]", 
       RowBox[{
        RowBox[{"Ao", " ", "Ro\[Infinity]"}], "+", 
        RowBox[{"Ai", " ", "Ri\[Infinity]"}]}]}], ",", 
      RowBox[{"Rcp\[Infinity]", "\[Equal]", 
       RowBox[{
        RowBox[{"Ao", " ", "Rop\[Infinity]"}], "+", 
        RowBox[{"Ai", " ", "Rip\[Infinity]"}]}]}]}], "}"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Ri\[Infinity]", "\[Rule]", 
       RowBox[{"RIn", "[", "r\[Infinity]", "]"}]}], ",", 
      RowBox[{"Ro\[Infinity]", "\[Rule]", 
       RowBox[{"ROut", "[", "r\[Infinity]", "]"}]}], ",", 
      RowBox[{"Rc\[Infinity]", "\[Rule]", 
       RowBox[{"RCausal", "[", "r\[Infinity]", "]"}]}], ",", 
      RowBox[{"Rip\[Infinity]", "\[Rule]", 
       RowBox[{
        RowBox[{"RIn", "'"}], "[", "r\[Infinity]", "]"}]}], ",", 
      RowBox[{"Rop\[Infinity]", "\[Rule]", 
       RowBox[{
        RowBox[{"ROut", "'"}], "[", "r\[Infinity]", "]"}]}], ",", 
      RowBox[{"Rcp\[Infinity]", "\[Rule]", 
       RowBox[{
        RowBox[{"RCausal", "'"}], "[", "r\[Infinity]", "]"}]}], ",", 
      RowBox[{"r0", "\[Rule]", 
       RowBox[{"1", "+", "\[Epsilon]"}]}], ",", 
      RowBox[{"r\[Infinity]", "\[Rule]", "20"}]}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"Ai", ",", "Ao"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  FractionBox[
   SuperscriptBox[
    RowBox[{"Abs", "[", "AIn", "]"}], "2"], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"Abs", "[", "AIn", "]"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"Abs", "[", "AOut", "]"}], "2"]}]], "/.", 
  "fit"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      FractionBox["AOut", "AIn"], "]"}], "2"], ",", 
    RowBox[{"1", "-", 
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       FractionBox["AOut", "AIn"], "]"}], "2"]}]}], "}"}], "/.", 
  "fit"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7337651950883713`*^9, 3.7337652655467157`*^9}, {
   3.733765318748848*^9, 3.733765428082851*^9}, {3.733765477612853*^9, 
   3.733765566566202*^9}, {3.7337656165473127`*^9, 3.733765649080511*^9}, {
   3.733765797279069*^9, 3.733765850958857*^9}, {3.7337658835102787`*^9, 
   3.7337659702806463`*^9}, {3.733766009142524*^9, 3.7337661714604807`*^9}, 
   3.733766208391695*^9, {3.73376625606137*^9, 3.7337663234893913`*^9}, {
   3.7337665292711277`*^9, 3.7337666014732857`*^9}, {3.733829025901231*^9, 
   3.73382904296515*^9}, {3.733829139786768*^9, 3.733829189991806*^9}, {
   3.7338293130617228`*^9, 3.733829345019865*^9}, {3.733829572537922*^9, 
   3.733829634816967*^9}, {3.7338298060977697`*^9, 3.733829828770608*^9}, {
   3.733829891636517*^9, 3.733829896145072*^9}, {3.7338299878779793`*^9, 
   3.733829991264902*^9}, {3.7338304217559643`*^9, 3.733830461272657*^9}, {
   3.733830654160995*^9, 3.733830664098876*^9}, {3.733835259291861*^9, 
   3.7338352679811087`*^9}, {3.73383547046799*^9, 3.7338355119223747`*^9}, {
   3.7338442316059303`*^9, 3.733844247066491*^9}, {3.7338443175774393`*^9, 
   3.7338443182480097`*^9}, {3.733844374599654*^9, 3.733844375334384*^9}, {
   3.734096274827175*^9, 3.734096286300482*^9}, {3.734096333670455*^9, 
   3.7340964119124107`*^9}, {3.734096444937689*^9, 3.734096445200152*^9}, {
   3.734344318796556*^9, 3.73434442251407*^9}, {3.734344558504681*^9, 
   3.734344574595109*^9}, {3.7343446052241783`*^9, 3.7343446568175573`*^9}, {
   3.734344690527401*^9, 3.734344924756035*^9}, {3.7343449725309687`*^9, 
   3.734345046152404*^9}, {3.734346386798182*^9, 3.734346446863762*^9}, {
   3.7343464791888523`*^9, 3.734346548601932*^9}, {3.7343465915360813`*^9, 
   3.734346598401927*^9}, {3.734346697207649*^9, 3.7343467007271423`*^9}, {
   3.73434676823101*^9, 3.73434679699477*^9}, {3.73434702123216*^9, 
   3.734347092199706*^9}, {3.734347137599045*^9, 3.7343471982412024`*^9}, {
   3.734347312898275*^9, 3.734347426796503*^9}, {3.734347509211895*^9, 
   3.734347524581262*^9}, {3.734347734937562*^9, 3.7343478104223137`*^9}, {
   3.7343478429425373`*^9, 3.734347868822612*^9}, {3.734348023026504*^9, 
   3.734348132620645*^9}, {3.734348246358975*^9, 3.734348510155177*^9}, {
   3.734348558554077*^9, 3.734348618872816*^9}, {3.734348729114985*^9, 
   3.7343487494253073`*^9}, {3.734348869916688*^9, 3.734348875312716*^9}, {
   3.73434890783607*^9, 3.734348922393915*^9}, {3.734348953680957*^9, 
   3.734349033847158*^9}, {3.738953996206747*^9, 3.738953997237629*^9}, {
   3.739027656121264*^9, 3.739027670851475*^9}, {3.73902778511043*^9, 
   3.739027825608823*^9}, {3.739027856215343*^9, 3.739027856645056*^9}, {
   3.739027909327305*^9, 3.739027912804034*^9}, {3.739027946077252*^9, 
   3.739027953743319*^9}, {3.7390279875009413`*^9, 3.739028011383523*^9}, 
   3.739028046393167*^9, {3.739028247801992*^9, 3.739028316858705*^9}, {
   3.7390285491012373`*^9, 3.739028556342064*^9}, {3.739028594228554*^9, 
   3.739028601573535*^9}, 3.739028683682886*^9, {3.7390287706465063`*^9, 
   3.7390287771150103`*^9}, {3.739028826887815*^9, 3.739028829457217*^9}, {
   3.7390288764026947`*^9, 3.739028893936558*^9}, {3.7390290448325243`*^9, 
   3.739029047769805*^9}, {3.739029081099266*^9, 3.7390290937039013`*^9}, {
   3.73902916172843*^9, 3.739029217779046*^9}, {3.739029411247167*^9, 
   3.7390294245938587`*^9}, {3.7390397267689543`*^9, 3.739039749409821*^9}, {
   3.739039979185437*^9, 3.739040064577298*^9}, 3.73904054492161*^9, 
   3.739040732308372*^9, {3.739051147001635*^9, 3.739051175081799*^9}, {
   3.739093939529018*^9, 3.739094008658128*^9}, {3.739094058339299*^9, 
   3.739094090786717*^9}, {3.73909437720286*^9, 3.739094381997006*^9}, 
   3.73909448308885*^9, 3.739094765887529*^9, {3.739095288628834*^9, 
   3.73909531241962*^9}, {3.739095431488855*^9, 3.739095441626342*^9}, {
   3.739095472829035*^9, 3.739095576156719*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"AIn", "\[Rule]", 
    RowBox[{
    "0.7934018232386954802255632219976072851129003185945848515896`28.\
40767638193436", "+", 
     RowBox[{
     "0.6859917067136833737844466738914905582567350922763699399686`28.\
40767638193436", " ", "\[ImaginaryI]"}]}]}], ",", 
   RowBox[{"AOut", "\[Rule]", 
    RowBox[{
     RowBox[{
     "-", "0.1045339243717267961575006012550436501379246691102240339042`28.\
40767638193436"}], "-", 
     RowBox[{
     "0.2985694784363041294828664668140479356351065165796194507442`28.\
40767638193436", " ", "\[ImaginaryI]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.739095532390377*^9, 3.739095577836936*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Ai", "\[Rule]", 
     RowBox[{
     "0.7934018232385176381370873631522074082340571983610424602056`28.\
75747310324167", "+", 
      RowBox[{
      "0.6859917067137429478140538820051696949995594775865165339201`28.\
75747310324167", " ", "\[ImaginaryI]"}]}]}], ",", 
    RowBox[{"Ao", "\[Rule]", 
     RowBox[{
      RowBox[{
      "-", "0.104533924371814258770188424042360891814920805519145244772`28.\
75747310324167"}], "-", 
      RowBox[{
      "0.2985694784361655470197261158805984932279270966626825074994`28.\
75747310324167", " ", "\[ImaginaryI]"}]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.739095532390377*^9, 3.739095577896604*^9}}],

Cell[BoxData["0.9166173150139696110744292703027349095151586287475065485411`27.\
805616390606396"], "Output",
 CellChangeTimes->{{3.739095532390377*^9, 3.739095577898954*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.0909678266166721973471008498565251752822787986545966933939`27.\
419941837004522", ",", 
   "0.9090321733833278026528991501434748247177212013454033066061`28.\
41963327272037"}], "}"}]], "Output",
 CellChangeTimes->{{3.739095532390377*^9, 3.7390955779010057`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Rc\[Infinity]", "\[Equal]", 
       RowBox[{
        RowBox[{"Ao", " ", "Ro\[Infinity]"}], "+", 
        RowBox[{"Ai", " ", "Ri\[Infinity]"}]}]}], ",", 
      RowBox[{"Rcp\[Infinity]", "\[Equal]", 
       RowBox[{
        RowBox[{"Ao", " ", "Rop\[Infinity]"}], "+", 
        RowBox[{"Ai", " ", "Rip\[Infinity]"}]}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Ai", ",", "Ao"}], "}"}]}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.739096374304264*^9, 3.739096380053358*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Ai", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"Rc\[Infinity]", " ", "Rop\[Infinity]"}], "-", 
       RowBox[{"Rcp\[Infinity]", " ", "Ro\[Infinity]"}]}], 
      RowBox[{
       RowBox[{"Ri\[Infinity]", " ", "Rop\[Infinity]"}], "-", 
       RowBox[{"Rip\[Infinity]", " ", "Ro\[Infinity]"}]}]]}], ",", 
    RowBox[{"Ao", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"Rc\[Infinity]", " ", "Rip\[Infinity]"}], "-", 
       RowBox[{"Rcp\[Infinity]", " ", "Ri\[Infinity]"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "Ri\[Infinity]"}], " ", "Rop\[Infinity]"}], "+", 
       RowBox[{"Rip\[Infinity]", " ", "Ro\[Infinity]"}]}]]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.7390963762807007`*^9, 3.739096380402793*^9}}]
}, Open  ]]
},
WindowSize->{1411, 1102},
WindowMargins->{{262, Automatic}, {15, Automatic}},
Magnification:>2. Inherited,
FrontEndVersion->"10.0 for Linux x86 (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 238, 5, 129, "Input"],
Cell[CellGroupData[{
Cell[821, 29, 22212, 579, 3266, "Input"],
Cell[23036, 610, 690, 18, 129, "Output"],
Cell[23729, 630, 721, 19, 129, "Output"],
Cell[24453, 651, 174, 2, 89, "Output"],
Cell[24630, 655, 307, 7, 89, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24974, 667, 609, 17, 129, "Input"],
Cell[25586, 686, 836, 22, 181, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

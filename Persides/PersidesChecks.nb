(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     43603,       1264]
NotebookOptionsPosition[     42628,       1228]
NotebookOutlinePosition[     42995,       1244]
CellTagsIndexPosition[     42952,       1241]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.711388047802121*^9, 3.711388049190546*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Df", "[", 
    RowBox[{"r_", ",", "s_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "\[NotEqual]", 
       RowBox[{"-", "1"}]}], "&&", 
      RowBox[{"0", "\[LessEqual]", "t", "<", 
       RowBox[{"s", "+", "1"}]}]}], ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"s", "-", "t"}]], 
       RowBox[{"s", "!"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"r", "+", "1"}], ")"}], 
        RowBox[{"s", "-", "t", "+", "1"}]], 
       RowBox[{"t", "!"}]}]], ",", 
     RowBox[{
      RowBox[{"r", "\[Equal]", 
       RowBox[{"-", "1"}]}], "&&", 
      RowBox[{"t", "\[Equal]", 
       RowBox[{"s", "+", "1"}]}]}], ",", 
     FractionBox["1", 
      RowBox[{"s", "+", "1"}]], ",", "True", ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pp", "[", 
    RowBox[{"l_", ",", "r_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "<", "0"}], "||", 
      RowBox[{"r", ">", "l"}]}], ",", "0", ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "r"], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"l", "+", "r"}], ")"}], "!"}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"r", "!"}], ")"}], "2"], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"l", "-", "r"}], ")"}], "!"}]}]]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qp", "[", 
    RowBox[{"l_", ",", "r_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"r", "<", "0"}], ",", "0", ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"l", "+", "1"}]], 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"l", "+", "r"}], ")"}], "!"}], ")"}], "2"], 
       RowBox[{"2", 
        RowBox[{"r", "!"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "l"}], "+", "r", "+", "1"}], ")"}], "!"}]}]]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]", "[", "l_", "]"}], ":=", 
   RowBox[{"HarmonicNumber", "[", "l", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"X0", "[", 
    RowBox[{"l_", ",", "y_"}], "]"}], ":=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], "l"], 
    RowBox[{"LegendreP", "[", 
     RowBox[{"l", ",", "0", ",", "3", ",", 
      RowBox[{"1", "-", 
       RowBox[{"2", "y"}]}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"X1", "[", 
    RowBox[{"l_", ",", "y_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"I", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "l"], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", 
        RowBox[{"\[Sigma]", "[", "l", "]"}]}], "-", "y", "-", 
       RowBox[{"Log", "[", 
        RowBox[{"y", "-", "1"}], "]"}]}], ")"}], 
     RowBox[{"LegendreP", "[", 
      RowBox[{"l", ",", "0", ",", "3", ",", 
       RowBox[{"1", "-", 
        RowBox[{"2", "y"}]}]}], "]"}]}], "+", 
    RowBox[{"2", "I", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "l"], 
     RowBox[{"LegendreQ", "[", 
      RowBox[{"l", ",", "0", ",", "3", ",", 
       RowBox[{"1", "-", 
        RowBox[{"2", "y"}]}]}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"l", "=", "2"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Limit", "[", 
      RowBox[{
       RowBox[{"X0", "[", 
        RowBox[{"l", ",", "y"}], "]"}], ",", 
       RowBox[{"y", "\[Rule]", "1"}], ",", 
       RowBox[{"Direction", "\[Rule]", 
        RowBox[{"-", "1"}]}]}], "]"}], "\[Equal]", 
     RowBox[{"1", "\[IndentingNewLine]", 
      RowBox[{"Limit", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"X0", "[", 
           RowBox[{"l", ",", "y"}], "]"}], ",", "y"}], "]"}], ",", 
        RowBox[{"y", "\[Rule]", "1"}], ",", 
        RowBox[{"Direction", "\[Rule]", 
         RowBox[{"-", "1"}]}]}], "]"}]}], "\[Equal]", 
     RowBox[{"l", 
      RowBox[{"(", 
       RowBox[{"l", "+", "1"}], ")"}], "\[IndentingNewLine]", 
      RowBox[{"Limit", "[", 
       RowBox[{
        RowBox[{"X1", "[", 
         RowBox[{"l", ",", "y"}], "]"}], ",", 
        RowBox[{"y", "\[Rule]", "1"}], ",", 
        RowBox[{"Direction", "\[Rule]", 
         RowBox[{"-", "1"}]}]}], "]"}]}], "\[Equal]", 
     RowBox[{"0", "\[IndentingNewLine]", 
      RowBox[{"Limit", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"X1", "[", 
           RowBox[{"l", ",", "y"}], "]"}], ",", "y"}], "]"}], ",", 
        RowBox[{"y", "\[Rule]", "1"}], ",", 
        RowBox[{"Direction", "\[Rule]", 
         RowBox[{"-", "1"}]}]}], "]"}]}], "\[Equal]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"l", 
         RowBox[{"(", 
          RowBox[{"l", "+", "1"}], ")"}]}], "+", "1"}], ")"}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "I"}], ")"}], "1"]}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.734349734243965*^9, 3.734349734467532*^9}, {
   3.734349836164188*^9, 3.734349874586238*^9}, {3.734349904823903*^9, 
   3.7343499808281803`*^9}, {3.734351006929475*^9, 3.734351077800847*^9}, {
   3.734351117004155*^9, 3.734351127988825*^9}, {3.734351174949709*^9, 
   3.73435131872512*^9}, {3.7343516379591846`*^9, 3.734351641027722*^9}, 
   3.734351820924114*^9, 3.734462837847192*^9, {3.7345457956351213`*^9, 
   3.734545802748595*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", "I", " ", 
        RowBox[{"LegendreQ", "[", 
         RowBox[{"l", ",", "0", ",", "3", ",", 
          RowBox[{"1", "-", 
           RowBox[{"2", "y"}]}]}], "]"}], 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{"yp", " ", 
           RowBox[{"X0", "[", 
            RowBox[{"l", ",", "yp"}], "]"}], 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"yp", " ", 
              RowBox[{"LegendreP", "[", 
               RowBox[{"l", ",", "0", ",", "3", ",", 
                RowBox[{"1", "-", 
                 RowBox[{"2", "yp"}]}]}], "]"}]}], ",", "yp"}], "]"}]}], ",", 
          
          RowBox[{"{", 
           RowBox[{"yp", ",", "1.001", ",", "y"}], "}"}]}], "]"}]}], "-", 
       RowBox[{"4", "I", " ", 
        RowBox[{"LegendreP", "[", 
         RowBox[{"l", ",", "0", ",", "3", ",", 
          RowBox[{"1", "-", 
           RowBox[{"2", "y"}]}]}], "]"}], 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{"yp", " ", 
           RowBox[{"X0", "[", 
            RowBox[{"l", ",", "yp"}], "]"}], 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"yp", " ", 
              RowBox[{"LegendreQ", "[", 
               RowBox[{"l", ",", "0", ",", "3", ",", 
                RowBox[{"1", "-", 
                 RowBox[{"2", "yp"}]}]}], "]"}]}], ",", "yp"}], "]"}]}], ",", 
          
          RowBox[{"{", 
           RowBox[{"yp", ",", "1.001", ",", "y"}], "}"}]}], "]"}]}]}], ")"}], 
     "/.", 
     RowBox[{"y", "\[Rule]", 
      RowBox[{"2", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "4"}], "I", " ", 
          RowBox[{"LegendreQ", "[", 
           RowBox[{"l", ",", "0", ",", "3", ",", 
            RowBox[{"1", "-", 
             RowBox[{"2", "y"}]}]}], "]"}], 
          RowBox[{"Integrate", "[", 
           RowBox[{
            RowBox[{"yp", " ", 
             RowBox[{"LegendreP", "[", 
              RowBox[{"l", ",", "0", ",", "3", ",", 
               RowBox[{"1", "-", 
                RowBox[{"2", "yp"}]}]}], "]"}], 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"yp", " ", 
                RowBox[{"X0", "[", 
                 RowBox[{"l", ",", "yp"}], "]"}]}], ",", "yp"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"yp", ",", "1", ",", "y"}], "}"}]}], "]"}]}], "+", 
         RowBox[{"4", "I", " ", 
          RowBox[{"LegendreP", "[", 
           RowBox[{"l", ",", "0", ",", "3", ",", 
            RowBox[{"1", "-", 
             RowBox[{"2", "y"}]}]}], "]"}], 
          RowBox[{"Integrate", "[", 
           RowBox[{
            RowBox[{"yp", " ", 
             RowBox[{"LegendreQ", "[", 
              RowBox[{"l", ",", "0", ",", "3", ",", 
               RowBox[{"1", "-", 
                RowBox[{"2", "yp"}]}]}], "]"}], 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"yp", " ", 
                RowBox[{"X0", "[", 
                 RowBox[{"l", ",", "yp"}], "]"}]}], ",", "yp"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"yp", ",", "1", ",", "y"}], "}"}]}], "]"}]}]}], 
        ")"}]}]}]}], "/.", 
    RowBox[{"y", "\[Rule]", "2."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"X0", "[", 
     RowBox[{"l", ",", "y"}], "]"}], "/.", 
    RowBox[{"y", "\[Rule]", "2."}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "l"], 
        RowBox[{"pp", "[", 
         RowBox[{"l", ",", "r"}], "]"}], 
        SuperscriptBox["y", 
         RowBox[{"l", "-", "r"}]]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n", "\[Rule]", "2"}], ",", 
         RowBox[{"y", "\[Rule]", "2"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", "0", ",", "100"}], "}"}]}], "]"}], "//", "N"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"X1", "[", 
     RowBox[{"l", ",", "y"}], "]"}], "/.", 
    RowBox[{"y", "\[Rule]", "2."}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"2", 
                RowBox[{"\[Sigma]", "[", "l", "]"}]}]}], ")"}], "I", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "l"], 
             RowBox[{"pp", "[", 
              RowBox[{"l", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"l", "-", "r"}], ")"}], "-", "1"}]}], "]"}]}], "+", 
            RowBox[{"2", "I", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "l"], 
             RowBox[{"qp", "[", 
              RowBox[{"l", ",", 
               RowBox[{"r", "-", 
                RowBox[{"2", "l"}], "-", "2"}]}], "]"}]}], "-", 
            RowBox[{"I", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "l"], 
             RowBox[{"pp", "[", 
              RowBox[{"l", ",", 
               RowBox[{"(", 
                RowBox[{"l", "-", "r"}], ")"}]}], "]"}]}], "+", 
            RowBox[{"I", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "l"], 
             RowBox[{"Sum", "[", 
              RowBox[{
               FractionBox[
                RowBox[{"pp", "[", 
                 RowBox[{"l", ",", 
                  RowBox[{"r", "-", "m", "-", "2"}]}], "]"}], 
                RowBox[{"m", "+", "1"}]], ",", 
               RowBox[{"{", 
                RowBox[{"m", ",", "0", ",", "100"}], "}"}]}], "]"}]}]}], 
           ")"}], 
          SuperscriptBox["y", 
           RowBox[{"l", "+", "n", "-", "r"}]]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"n", "\[Rule]", "2"}], ",", 
           RowBox[{"y", "\[Rule]", "2"}]}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "0", ",", "200"}], "}"}]}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"I", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"l", "+", "1"}]], 
          RowBox[{"pp", "[", 
           RowBox[{"l", ",", 
            RowBox[{"r", "-", "1"}]}], "]"}], 
          SuperscriptBox["y", 
           RowBox[{"l", "+", "n", "-", "r"}]], 
          RowBox[{"Log", "[", "y", "]"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"n", "\[Rule]", "2"}], ",", 
           RowBox[{"y", "\[Rule]", "2"}]}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "0", ",", "200"}], "}"}]}], "]"}]}], ")"}], "//", 
    "N"}]}]}]], "Input",
 CellChangeTimes->{{3.734514091950458*^9, 3.734514181927512*^9}, {
  3.73451421244836*^9, 3.7345142414268*^9}, {3.7345145632734613`*^9, 
  3.734514691354793*^9}, {3.734514725490981*^9, 3.734514771019198*^9}, {
  3.734514826169273*^9, 3.734514860064815*^9}, {3.734515133165559*^9, 
  3.73451529060779*^9}, {3.7345165263610277`*^9, 3.734516528511448*^9}, {
  3.734544397786398*^9, 3.734544596414473*^9}, {3.7345446553216677`*^9, 
  3.734544655599821*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Log", "[", 
    RowBox[{"y", "-", "1"}], "]"}], 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"pp", "[", 
       RowBox[{"l", ",", "r"}], "]"}], 
      SuperscriptBox["y", 
       RowBox[{"l", "-", "r"}]]}], ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", "0", ",", "l"}], "}"}]}], "]"}]}], "/.", 
  RowBox[{"y", "\[Rule]", "2"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["y", 
       RowBox[{"l", "-", "r", "+", "1"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"0", 
         RowBox[{"Sum", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"pp", "[", 
             RowBox[{"l", ",", 
              RowBox[{"r", "-", "m", "-", "2"}]}], "]"}], 
            RowBox[{"m", "+", "1"}]], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", 
             RowBox[{"-", "100"}], ",", 
             RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], "+", 
        RowBox[{"Sum", "[", 
         RowBox[{
          FractionBox[
           RowBox[{"pp", "[", 
            RowBox[{"l", ",", 
             RowBox[{"r", "-", "m", "-", "2"}]}], "]"}], 
           RowBox[{"m", "+", "1"}]], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", "0", ",", "100"}], "}"}]}], "]"}], "-", 
        RowBox[{
         RowBox[{"pp", "[", 
          RowBox[{"l", ",", 
           RowBox[{"r", "-", "1"}]}], "]"}], 
         RowBox[{"Log", "[", "y", "]"}]}]}], ")"}]}], "/.", 
     RowBox[{"y", "\[Rule]", "2"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", 
      RowBox[{"-", "100"}], ",", "100"}], "}"}]}], "]"}], "//", 
  "N"}]}], "Input",
 CellChangeTimes->{{3.73454476661725*^9, 3.734544954983696*^9}, 
   3.7345453360785522`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.734544807634406*^9, 3.7345449248811207`*^9, 
  3.734544955767803*^9, 3.7345453374603987`*^9}],

Cell[BoxData[
 RowBox[{"-", "1.7763568394002505`*^-15"}]], "Output",
 CellChangeTimes->{3.734544807634406*^9, 3.7345449248811207`*^9, 
  3.734544955767803*^9, 3.734545337602037*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Sum", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"pp", "[", 
      RowBox[{"l", ",", 
       RowBox[{"r", "-", "m", "-", "2"}]}], "]"}], 
     RowBox[{"m", "+", "1"}]], ",", 
    RowBox[{"{", 
     RowBox[{"m", ",", 
      RowBox[{"r", "-", "2", "-", "l"}], ",", 
      RowBox[{"r", "-", "2"}]}], "}"}]}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.7345165443487463`*^9, 3.734516603439485*^9}, {
   3.73451673561201*^9, 3.7345168534578333`*^9}, 3.734545778911666*^9, {
   3.734545836714054*^9, 3.734545867115457*^9}, {3.7345459455754147`*^9, 
   3.7345459835828*^9}, {3.734546130692524*^9, 3.734546132795658*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        FractionBox["1", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "r"}]], 
        RowBox[{"l", "\[Equal]", "0"}]},
       {
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           RowBox[{"Gamma", "[", 
            RowBox[{"1", "-", "r"}], "]"}], " ", 
           RowBox[{"Gamma", "[", 
            RowBox[{"l", "+", "r"}], "]"}]}], 
          RowBox[{
           RowBox[{"Gamma", "[", 
            RowBox[{"2", "+", "l", "-", "r"}], "]"}], " ", 
           RowBox[{"Gamma", "[", "r", "]"}]}]]}], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}},
      Selectable->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{{3.734516587151821*^9, 3.7345166051536818`*^9}, {
   3.734516741274806*^9, 3.73451677109997*^9}, {3.734516806561627*^9, 
   3.7345168542384777`*^9}, {3.734545827984675*^9, 3.734545844790291*^9}, 
   3.734545988037497*^9, 3.734546133571702*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"Gamma", "[", 
         RowBox[{"1", "-", "r"}], "]"}], " ", 
        RowBox[{"Gamma", "[", 
         RowBox[{"l", "+", "r"}], "]"}]}], 
       RowBox[{
        RowBox[{"Gamma", "[", 
         RowBox[{"2", "+", "l", "-", "r"}], "]"}], " ", 
        RowBox[{"Gamma", "[", "r", "]"}]}]]}], "/.", 
     RowBox[{"l", "\[Rule]", "8"}]}], ",", 
    RowBox[{"r", "\[Rule]", 
     RowBox[{"-", "1000000"}]}]}], "]"}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.734546194639042*^9, 3.734546283759882*^9}, {
  3.7345463367365627`*^9, 3.734546407106682*^9}}],

Cell[BoxData[
 RowBox[{"-", "9.999270027369289`*^-7"}]], "Output",
 CellChangeTimes->{{3.734546224491886*^9, 3.734546262893469*^9}, {
  3.734546343279212*^9, 3.7345464078372393`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"r", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "-", "r"}], ")"}], "!"}], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "l", "+", "r"}], ")"}], "!"}]}], 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "l", "-", "r"}], ")"}], "!"}], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "r"}], ")"}], "!"}]}]], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.734546059792029*^9, 3.734546126298686*^9}}],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{
   RowBox[{"-", "1"}], "+", "r"}]]], "Output",
 CellChangeTimes->{{3.734546061946138*^9, 3.734546116299985*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"Gamma", "[", 
     RowBox[{"1", "-", "r"}], "]"}], " ", 
    RowBox[{"Gamma", "[", 
     RowBox[{"l", "+", "r"}], "]"}]}], 
   RowBox[{
    RowBox[{"Gamma", "[", 
     RowBox[{"2", "+", "l", "-", "r"}], "]"}], " ", 
    RowBox[{"Gamma", "[", "r", "]"}]}]]}]], "Output",
 CellChangeTimes->{{3.734546061946138*^9, 3.734546116319943*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"X2", "[", 
    RowBox[{"l_", ",", "y_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"4", "I", " ", 
     RowBox[{"LegendreQ", "[", 
      RowBox[{"l", ",", "0", ",", "3", ",", 
       RowBox[{"1", "-", 
        RowBox[{"2", "y"}]}]}], "]"}], 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"yp", " ", 
        RowBox[{"X1", "[", 
         RowBox[{"l", ",", "yp"}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"yp", " ", 
           RowBox[{"LegendreP", "[", 
            RowBox[{"l", ",", "0", ",", "3", ",", 
             RowBox[{"1", "-", 
              RowBox[{"2", "yp"}]}]}], "]"}]}], ",", "yp"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"yp", ",", "1", ",", "y"}], "}"}]}], "]"}]}], "-", 
    RowBox[{"4", "I", " ", 
     RowBox[{"LegendreP", "[", 
      RowBox[{"l", ",", "0", ",", "3", ",", 
       RowBox[{"1", "-", 
        RowBox[{"2", "y"}]}]}], "]"}], 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"yp", " ", 
        RowBox[{"X1", "[", 
         RowBox[{"l", ",", "yp"}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"yp", " ", 
           RowBox[{"LegendreQ", "[", 
            RowBox[{"l", ",", "0", ",", "3", ",", 
             RowBox[{"1", "-", 
              RowBox[{"2", "yp"}]}]}], "]"}]}], ",", "yp"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"yp", ",", "1", ",", "y"}], "}"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"X2alt", "[", 
    RowBox[{"l_", ",", "y_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "4"}], "I", " ", 
     RowBox[{"LegendreQ", "[", 
      RowBox[{"l", ",", "0", ",", "3", ",", 
       RowBox[{"1", "-", 
        RowBox[{"2", "y"}]}]}], "]"}], 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"yp", " ", 
        RowBox[{"LegendreP", "[", 
         RowBox[{"l", ",", "0", ",", "3", ",", 
          RowBox[{"1", "-", 
           RowBox[{"2", "yp"}]}]}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"yp", " ", 
           RowBox[{"X1", "[", 
            RowBox[{"l", ",", "yp"}], "]"}]}], ",", "yp"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"yp", ",", "1", ",", "y"}], "}"}]}], "]"}]}], "+", 
    RowBox[{"4", "I", " ", 
     RowBox[{"LegendreP", "[", 
      RowBox[{"l", ",", "0", ",", "3", ",", 
       RowBox[{"1", "-", 
        RowBox[{"2", "y"}]}]}], "]"}], 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"yp", " ", 
        RowBox[{"LegendreQ", "[", 
         RowBox[{"l", ",", "0", ",", "3", ",", 
          RowBox[{"1", "-", 
           RowBox[{"2", "yp"}]}]}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"yp", " ", 
           RowBox[{"X1", "[", 
            RowBox[{"l", ",", "yp"}], "]"}]}], ",", "yp"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"yp", ",", "1", ",", "y"}], "}"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X2", "[", 
   RowBox[{"2", ",", "10"}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X2alt", "[", 
   RowBox[{"2", ",", "10"}], "]"}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.73434963530274*^9, 3.734349797962701*^9}, {
  3.734349842700336*^9, 3.734349846275546*^9}, {3.7343509322445583`*^9, 
  3.734350963243327*^9}, {3.7343517420223513`*^9, 3.7343518429613447`*^9}, {
  3.734351881197362*^9, 3.73435194618469*^9}, {3.7344627929513197`*^9, 
  3.7344628186503077`*^9}, {3.7344628537973127`*^9, 3.734462882553817*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nmax", "=", "3"}], ";", 
  RowBox[{"rmax", "=", "3"}], ";", 
  RowBox[{"smax", "=", "3"}], ";", 
  RowBox[{"tmax", "=", "10"}], ";", 
  RowBox[{"l", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", 
       RowBox[{"nmax", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", "0", ",", 
       RowBox[{"rmax", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "0", ",", 
       RowBox[{"smax", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", ";;", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "l"], 
      RowBox[{"pp", "[", 
       RowBox[{"l", ",", "r"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", "0", ",", 
       RowBox[{"rmax", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", ";;", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", 
          RowBox[{"\[Sigma]", "[", "l", "]"}]}]}], ")"}], "I", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "l"], 
       RowBox[{"pp", "[", 
        RowBox[{"l", ",", 
         RowBox[{"r", "-", "1"}]}], "]"}]}], "+", 
      RowBox[{"2", "I", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "l"], 
       RowBox[{"qp", "[", 
        RowBox[{"l", ",", 
         RowBox[{"r", "-", 
          RowBox[{"2", "l"}], "-", "2"}]}], "]"}]}], "-", 
      RowBox[{"I", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "l"], 
       RowBox[{"pp", "[", 
        RowBox[{"l", ",", "r"}], "]"}]}], "+", 
      RowBox[{"I", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "l"], 
       RowBox[{"Sum", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"pp", "[", 
           RowBox[{"l", ",", 
            RowBox[{"r", "-", "m", "-", "2"}]}], "]"}], 
          RowBox[{"m", "+", "1"}]], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "0", ",", 
           RowBox[{"r", "-", "2"}]}], "}"}]}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", "0", ",", 
       RowBox[{"rmax", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", ";;", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"I", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"l", "+", "1"}]], 
      RowBox[{"pp", "[", 
       RowBox[{"l", ",", 
        RowBox[{"r", "-", "1"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", "0", ",", 
       RowBox[{"rmax", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B1D", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", "<", "2"}], ",", "0", ",", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"l", "-", "t", "+", "u", "+", "1"}], ")"}], 
           RowBox[{"pp", "[", 
            RowBox[{"l", ",", 
             RowBox[{"t", "-", "u"}]}], "]"}], 
           RowBox[{"A", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", 
              RowBox[{"u", "+", "1"}], ",", 
              RowBox[{"v", "+", "1"}]}], "]"}], "]"}], 
           RowBox[{"Df", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"2", "l"}], "+", "n", "-", "1"}], ",", "v", ",", "0"}], 
            "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"u", ",", "0", ",", 
            RowBox[{"rmax", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", 
            RowBox[{"u", "+", "l"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"v", ",", "0", ",", 
            RowBox[{"smax", "-", "1"}]}], "}"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"nmax", "-", "1"}]}], "}"}]}], "]"}], "//", "N"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "n", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", "3"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<``,``,``\>\"", ",", "u", ",", "t", ",", "v"}], "]"}], 
          "]"}], ";", 
         RowBox[{"Print", "[", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<``,``,``,``\>\"", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"l", "-", "t", "+", "u", "+", "1"}], ")"}], "//", "N"}],
             ",", 
            RowBox[{
             RowBox[{"pp", "[", 
              RowBox[{"l", ",", 
               RowBox[{"t", "-", "u"}]}], "]"}], "//", "N"}], ",", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", 
                RowBox[{"u", "+", "1"}], ",", 
                RowBox[{"v", "+", "1"}]}], "]"}], "]"}], "//", "N"}], ",", 
            RowBox[{
             RowBox[{"Df", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"2", "l"}], "+", "n", "-", "1"}], ",", "v", ",", 
               "0"}], "]"}], "//", "N"}]}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", "0", ",", 
          RowBox[{"rmax", "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{"u", "+", "l"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v", ",", "0", ",", 
          RowBox[{"smax", "-", "1"}]}], "}"}]}], "]"}]}]}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C1D", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", "<", "2"}], ",", "0", ",", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "l"}], "-", "t", "+", "u"}], ")"}], 
           RowBox[{"qp", "[", 
            RowBox[{"l", ",", 
             RowBox[{"t", "-", "u"}]}], "]"}], 
           RowBox[{"A", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", 
              RowBox[{"u", "+", "1"}], ",", 
              RowBox[{"v", "+", "1"}]}], "]"}], "]"}], 
           RowBox[{"Df", "[", 
            RowBox[{
             RowBox[{"n", "-", "1", "-", "t"}], ",", "v", ",", "0"}], "]"}]}],
           ",", 
          RowBox[{"{", 
           RowBox[{"u", ",", "0", ",", 
            RowBox[{"rmax", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", 
            RowBox[{"tmax", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"v", ",", "0", ",", 
            RowBox[{"smax", "-", "1"}]}], "}"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"nmax", "-", "1"}]}], "}"}]}], "]"}], "//", "N"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "n", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", "2"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<``,``,``\>\"", ",", "u", ",", "t", ",", "v"}], "]"}], 
          "]"}], ";", 
         RowBox[{"Print", "[", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<``,``,``,``\>\"", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "l"}], "-", "t", "+", "u"}], ")"}], "//", "N"}], 
            ",", 
            RowBox[{
             RowBox[{"qp", "[", 
              RowBox[{"l", ",", 
               RowBox[{"t", "-", "u"}]}], "]"}], "//", "N"}], ",", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", 
                RowBox[{"u", "+", "1"}], ",", 
                RowBox[{"v", "+", "1"}]}], "]"}], "]"}], "//", "N"}], ",", 
            RowBox[{
             RowBox[{"Df", "[", 
              RowBox[{
               RowBox[{"n", "-", "1", "-", "t"}], ",", "v", ",", "0"}], "]"}],
              "//", "N"}]}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{"tmax", "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", "0", ",", 
          RowBox[{"rmax", "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v", ",", "0", ",", 
          RowBox[{"smax", "-", "1"}]}], "}"}]}], "]"}]}]}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B3D", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "<", "2"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"l", "-", "t", "+", "u", "+", "1"}], ")"}], 
           RowBox[{"pp", "[", 
            RowBox[{"l", ",", 
             RowBox[{"t", "-", "u"}]}], "]"}], 
           RowBox[{"A", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", 
              RowBox[{"u", "+", "1"}], ",", 
              RowBox[{"v", "+", "1"}]}], "]"}], "]"}], 
           RowBox[{"Df", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"2", "l"}], "+", "n", "-", "t"}], ",", "v", ",", "s"}], 
            "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"u", ",", "0", ",", 
            RowBox[{"rmax", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"v", ",", "0", ",", 
            RowBox[{"smax", "-", "1"}]}], "}"}]}], "]"}], "-", 
        RowBox[{
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{"s", ",", "0"}], "]"}], 
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{"t", ",", 
           RowBox[{
            RowBox[{"2", "l"}], "+", "n", "+", "1"}]}], "]"}], 
         RowBox[{"B1D", "[", 
          RowBox[{"[", 
           RowBox[{"n", "+", "1"}], "]"}], "]"}]}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", 
       RowBox[{"nmax", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", 
       RowBox[{"rmax", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "0", ",", 
       RowBox[{"smax", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C3D", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "<", "2"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "l"}], "-", "t", "+", "u"}], ")"}], 
           RowBox[{"qp", "[", 
            RowBox[{"l", ",", 
             RowBox[{"t", "-", "u"}]}], "]"}], 
           RowBox[{"A", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", 
              RowBox[{"u", "+", "1"}], ",", 
              RowBox[{"v", "+", "1"}]}], "]"}], "]"}], 
           RowBox[{"Df", "[", 
            RowBox[{
             RowBox[{"n", "-", "1", "-", "t"}], ",", "v", ",", "s"}], "]"}]}],
           ",", 
          RowBox[{"{", 
           RowBox[{"u", ",", "0", ",", 
            RowBox[{"rmax", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"v", ",", "0", ",", 
            RowBox[{"smax", "-", "1"}]}], "}"}]}], "]"}], "-", 
        RowBox[{
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{"s", ",", "0"}], "]"}], 
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{"t", ",", "n"}], "]"}], 
         RowBox[{"C1D", "[", 
          RowBox[{"[", 
           RowBox[{"n", "+", "1"}], "]"}], "]"}]}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", 
       RowBox[{"nmax", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", 
       RowBox[{"rmax", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "0", ",", 
       RowBox[{"smax", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"4", "I", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"qp", "[", 
           RowBox[{"l", ",", 
            RowBox[{"r", "-", "t"}]}], "]"}], 
          RowBox[{"B3D", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"n", "+", "1"}], ",", 
             RowBox[{"t", "+", "1"}], ",", 
             RowBox[{"s", "+", "1"}]}], "]"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"pp", "[", 
           RowBox[{"l", ",", 
            RowBox[{"r", "-", "t"}]}], "]"}], 
          RowBox[{"C3D", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"n", "+", "1"}], ",", 
             RowBox[{"t", "+", "1"}], ",", 
             RowBox[{"s", "+", "1"}]}], "]"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "r"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", 
       RowBox[{"nmax", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", "0", ",", 
       RowBox[{"rmax", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "0", ",", 
       RowBox[{"smax", "-", "1"}]}], "}"}]}], "]"}], "//", "N"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.734181396013713*^9, 3.734181418466455*^9}, {
   3.734181452909252*^9, 3.7341814809212427`*^9}, {3.734181529213047*^9, 
   3.734181810666366*^9}, {3.734181879361382*^9, 3.734181885536928*^9}, {
   3.734181955580337*^9, 3.734182016221758*^9}, {3.73418270452496*^9, 
   3.734182724822246*^9}, {3.734182785487862*^9, 3.7341828012724857`*^9}, {
   3.7341828546507483`*^9, 3.7341828619984407`*^9}, {3.734182980834309*^9, 
   3.7341829813182173`*^9}, {3.7342706926463337`*^9, 3.734270726073566*^9}, {
   3.734270816743113*^9, 3.734270823482252*^9}, {3.734272252340819*^9, 
   3.734272424595068*^9}, {3.734272528436475*^9, 3.73427269285349*^9}, {
   3.734272834611409*^9, 3.734272940237831*^9}, {3.734273077303165*^9, 
   3.734273094527185*^9}, {3.7342731312054777`*^9, 3.73427315952274*^9}, {
   3.7342739344575653`*^9, 3.734273972633025*^9}, {3.734274002912745*^9, 
   3.73427400303345*^9}, {3.734274212199842*^9, 3.734274216264743*^9}, {
   3.7342742764045773`*^9, 3.7342742813574743`*^9}, {3.734274363186915*^9, 
   3.734274365331407*^9}, {3.734274445461753*^9, 3.7342746492720413`*^9}, {
   3.7342746897914877`*^9, 3.734274734364358*^9}, {3.734274777232333*^9, 
   3.7342748601109962`*^9}, {3.734274912379801*^9, 3.734274930311034*^9}, {
   3.734275006593054*^9, 3.734275006941022*^9}, {3.734275051375636*^9, 
   3.73427509384696*^9}, {3.734275167542556*^9, 3.734275215131918*^9}, {
   3.734275545561103*^9, 3.734275775853765*^9}, {3.734276027786037*^9, 
   3.734276160572055*^9}, {3.734276218300043*^9, 3.734276299123815*^9}, {
   3.734276333565529*^9, 3.73427634864174*^9}, {3.7342768067910967`*^9, 
   3.7342768278139677`*^9}, {3.7342769734402933`*^9, 3.734276981796104*^9}, {
   3.734277012150364*^9, 3.734277030778028*^9}, {3.734277100662395*^9, 
   3.73427714424852*^9}, {3.734277178408342*^9, 3.734277206394346*^9}, {
   3.7342772634485903`*^9, 3.7342772936539497`*^9}, 3.7342773657861853`*^9, {
   3.734277467238863*^9, 3.73427749704528*^9}, {3.734279470731307*^9, 
   3.734279489849943*^9}, {3.7342795468192997`*^9, 3.734279557747238*^9}, {
   3.734279774433715*^9, 3.734279789194049*^9}, {3.734349626782937*^9, 
   3.734349627703195*^9}, {3.734354509602315*^9, 3.7343545096827393`*^9}, {
   3.734354542093657*^9, 3.734354568323802*^9}, {3.734356270532048*^9, 
   3.7343562941545897`*^9}, {3.734356326935486*^9, 3.734356327351636*^9}, {
   3.734365570809181*^9, 3.734365571631283*^9}, {3.7343656124766417`*^9, 
   3.734365613209261*^9}, {3.7343656888144493`*^9, 3.7343657295125837`*^9}, {
   3.7343659134020157`*^9, 3.734365921143525*^9}, {3.734365963819545*^9, 
   3.7343660575419827`*^9}, 3.734366134148982*^9, {3.7343663287791367`*^9, 
   3.734366339538569*^9}, {3.734366943585025*^9, 3.7343669698704557`*^9}, {
   3.73436700183654*^9, 3.734367145710188*^9}, {3.734367214303486*^9, 
   3.7343672479100637`*^9}, {3.7343729946331997`*^9, 3.734373017533224*^9}, {
   3.734373050514456*^9, 3.734373063683758*^9}, {3.734373132988531*^9, 
   3.734373143979958*^9}, {3.734373219844614*^9, 3.7343732397879343`*^9}, {
   3.734373425177849*^9, 3.734373432555072*^9}, {3.734373469247121*^9, 
   3.7343735291518507`*^9}, {3.734373612587016*^9, 3.734373641318762*^9}, {
   3.734373675858728*^9, 3.7343736769776363`*^9}, {3.7343737598843727`*^9, 
   3.734373780604466*^9}, {3.734373812237858*^9, 3.734374056633613*^9}, 
   3.734374124790337*^9, {3.734428716238625*^9, 3.734428719327388*^9}, {
   3.7344298358261633`*^9, 3.734429843290082*^9}}]
},
WindowSize->{1315, 728},
WindowMargins->{{41, Automatic}, {Automatic, 67}},
Magnification:>2. Inherited,
FrontEndVersion->"10.0 for Linux x86 (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 238, 5, 97, "Input"],
Cell[799, 27, 5909, 185, 744, "Input"],
Cell[6711, 214, 7544, 209, 903, "Input"],
Cell[CellGroupData[{
Cell[14280, 427, 1795, 56, 339, "Input"],
Cell[16078, 485, 143, 2, 86, "Output"],
Cell[16224, 489, 181, 3, 86, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16442, 497, 676, 17, 96, "Input"],
Cell[17121, 516, 2232, 62, 151, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19390, 583, 693, 20, 128, "Input"],
Cell[20086, 605, 183, 3, 119, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20306, 613, 590, 21, 101, "Input"],
Cell[20899, 636, 156, 4, 113, "Output"],
Cell[21058, 642, 404, 12, 119, "Output"]
}, Open  ]],
Cell[21477, 657, 3589, 101, 541, "Input"],
Cell[25069, 760, 17555, 466, 1968, "Input"]
}
]
*)

(* End of internal cache information *)

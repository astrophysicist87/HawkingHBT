(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     35559,        969]
NotebookOptionsPosition[     34703,        937]
NotebookOutlinePosition[     35072,        953]
CellTagsIndexPosition[     35029,        950]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.711388047802121*^9, 3.711388049190546*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Df", "[", 
    RowBox[{"r_", ",", "s_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "\[NotEqual]", 
       RowBox[{"-", "1"}]}], "&&", 
      RowBox[{"0", "\[LessEqual]", "t", "<", 
       RowBox[{"s", "+", "1"}]}]}], ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"s", "-", "t"}]], 
       RowBox[{"s", "!"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"r", "+", "1"}], ")"}], 
        RowBox[{"s", "-", "t", "+", "1"}]], 
       RowBox[{"t", "!"}]}]], ",", 
     RowBox[{
      RowBox[{"r", "\[Equal]", 
       RowBox[{"-", "1"}]}], "&&", 
      RowBox[{"t", "\[Equal]", 
       RowBox[{"s", "+", "1"}]}]}], ",", 
     FractionBox["1", 
      RowBox[{"s", "+", "1"}]], ",", "True", ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pp", "[", 
    RowBox[{"l_", ",", "r_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "<", "0"}], "||", 
      RowBox[{"r", ">", "l"}]}], ",", "0", ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "r"], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"l", "+", "r"}], ")"}], "!"}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"r", "!"}], ")"}], "2"], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"l", "-", "r"}], ")"}], "!"}]}]]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qp", "[", 
    RowBox[{"l_", ",", "r_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"r", "<", "0"}], ",", "0", ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"l", "+", "1"}]], 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"l", "+", "r"}], ")"}], "!"}], ")"}], "2"], 
       RowBox[{"2", 
        RowBox[{"r", "!"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "l"}], "+", "r", "+", "1"}], ")"}], "!"}]}]]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]", "[", "l_", "]"}], ":=", 
   RowBox[{"HarmonicNumber", "[", "l", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"X0", "[", 
    RowBox[{"l_", ",", "y_"}], "]"}], ":=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], "l"], 
    RowBox[{"LegendreP", "[", 
     RowBox[{"l", ",", "0", ",", "3", ",", 
      RowBox[{"1", "-", 
       RowBox[{"2", "y"}]}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"X1", "[", 
    RowBox[{"l_", ",", "y_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"I", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "l"], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", 
        RowBox[{"\[Sigma]", "[", "l", "]"}]}], "-", "y", "-", 
       RowBox[{"Log", "[", 
        RowBox[{"y", "-", "1"}], "]"}]}], ")"}], 
     RowBox[{"LegendreP", "[", 
      RowBox[{"l", ",", "0", ",", "3", ",", 
       RowBox[{"1", "-", 
        RowBox[{"2", "y"}]}]}], "]"}]}], "+", 
    RowBox[{"2", "I", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "l"], 
     RowBox[{"LegendreQ", "[", 
      RowBox[{"l", ",", "0", ",", "3", ",", 
       RowBox[{"1", "-", 
        RowBox[{"2", "y"}]}]}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"X1", "[", 
    RowBox[{"l_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"I", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], "l"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", 
          RowBox[{"\[Sigma]", "[", "l", "]"}]}], "-", "y", "-", 
         RowBox[{"Log", "[", 
          RowBox[{"y", "-", "1"}], "]"}]}], ")"}], 
       RowBox[{"LegendreP", "[", 
        RowBox[{"l", ",", "0", ",", "3", ",", 
         RowBox[{"1", "-", 
          RowBox[{"2", "y"}]}]}], "]"}]}], "+", 
      RowBox[{"2", 
       RowBox[{"LegendreQ", "[", 
        RowBox[{"l", ",", "0", ",", "3", ",", 
         RowBox[{"1", "-", 
          RowBox[{"2", "y"}]}]}], "]"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"rmax", "=", "l"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"X1alt", "[", 
    RowBox[{"l_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"I", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], "l"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox["y", 
          RowBox[{"l", "-", "r", "+", "1"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"2", 
               RowBox[{"\[Sigma]", "[", "l", "]"}]}], "-", 
              RowBox[{"Log", "[", "y", "]"}]}], ")"}], 
            RowBox[{"pp", "[", 
             RowBox[{"l", ",", 
              RowBox[{"l", "-", "r", "+", "1"}]}], "]"}]}], "-", 
           RowBox[{"pp", "[", 
            RowBox[{"l", ",", 
             RowBox[{"l", "-", "r"}]}], "]"}], "+", 
           RowBox[{"2", 
            RowBox[{"qp", "[", 
             RowBox[{"l", ",", 
              RowBox[{"r", "-", 
               RowBox[{"2", "l"}], "-", "2"}]}], "]"}]}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", 
          RowBox[{"-", "rmax"}], ",", "rmax"}], "}"}]}], "]"}], "-", 
      RowBox[{"2", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox["y", 
           RowBox[{"l", "-", "r", "+", "1"}]], 
          RowBox[{"pp", "[", 
           RowBox[{"l", ",", 
            RowBox[{"l", "-", "r", "+", "s", "+", "2"}]}], "]"}], 
          RowBox[{"qp", "[", 
           RowBox[{"0", ",", "s"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", 
           RowBox[{"-", "rmax"}], ",", "rmax"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", 
           RowBox[{"Max", "[", 
            RowBox[{"0", ",", 
             RowBox[{"r", "-", "l", "-", "2"}]}], "]"}], ",", 
           RowBox[{"r", "-", "2"}]}], "}"}]}], "]"}]}]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.734349734243965*^9, 3.734349734467532*^9}, {
   3.734349836164188*^9, 3.734349874586238*^9}, {3.734349904823903*^9, 
   3.7343499808281803`*^9}, {3.734351006929475*^9, 3.734351077800847*^9}, {
   3.734351117004155*^9, 3.734351127988825*^9}, {3.734351174949709*^9, 
   3.73435131872512*^9}, {3.7343516379591846`*^9, 3.734351641027722*^9}, 
   3.734351820924114*^9, 3.734462837847192*^9, {3.7345457956351213`*^9, 
   3.734545802748595*^9}, {3.734715196916991*^9, 3.734715197735838*^9}, {
   3.7347170339904327`*^9, 3.734717126685955*^9}, {3.734718665859078*^9, 
   3.734718730594008*^9}, 3.734718805560339*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"l", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X0", "[", 
   RowBox[{"l", ",", "y"}], "]"}], "/.", 
  RowBox[{"y", "\[Rule]", "2."}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X1", "[", 
   RowBox[{"l", ",", "y"}], "]"}], "/.", 
  RowBox[{"y", "\[Rule]", "2."}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X1alt", "[", 
   RowBox[{"l", ",", "y"}], "]"}], "/.", 
  RowBox[{"y", "\[Rule]", "2."}]}]}], "Input",
 CellChangeTimes->{{3.734514091950458*^9, 3.734514181927512*^9}, {
   3.73451421244836*^9, 3.7345142414268*^9}, {3.7345145632734613`*^9, 
   3.734514691354793*^9}, {3.734514725490981*^9, 3.734514771019198*^9}, {
   3.734514826169273*^9, 3.734514860064815*^9}, {3.734515133165559*^9, 
   3.73451529060779*^9}, {3.7345165263610277`*^9, 3.734516528511448*^9}, {
   3.734544397786398*^9, 3.734544596414473*^9}, {3.7345446553216677`*^9, 
   3.734544655599821*^9}, {3.734715202175362*^9, 3.734715204084939*^9}, {
   3.734717137233337*^9, 3.734717167978348*^9}, {3.734718646845482*^9, 
   3.734718655985664*^9}, {3.7347186905283337`*^9, 3.734718710448675*^9}, 
   3.7347188180665913`*^9, 3.734718990975853*^9, 3.734719709346325*^9}],

Cell[BoxData["8.097453`*^6"], "Output",
 CellChangeTimes->{
  3.734717005146924*^9, {3.7347171404538727`*^9, 3.734717168254397*^9}, {
   3.7347186470349216`*^9, 3.73471873220337*^9}, 3.734718818353127*^9, 
   3.734718991171811*^9, 3.73471970955802*^9}],

Cell[BoxData[
 RowBox[{"0.`", "\[VeryThinSpace]", "-", 
  RowBox[{"5.553181855000001`*^7", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{
  3.734717005146924*^9, {3.7347171404538727`*^9, 3.734717168254397*^9}, {
   3.7347186470349216`*^9, 3.73471873220337*^9}, 3.734718818353127*^9, 
   3.734718991171811*^9, 3.734719709559224*^9}],

Cell[BoxData[
 RowBox[{"0.`", "\[VeryThinSpace]", "-", 
  RowBox[{"5.553180714098024`*^7", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{
  3.734717005146924*^9, {3.7347171404538727`*^9, 3.734717168254397*^9}, {
   3.7347186470349216`*^9, 3.73471873220337*^9}, 3.734718818353127*^9, 
   3.734718991171811*^9, 3.734719709560314*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"X2", "[", 
    RowBox[{"l_", ",", "y_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"4", "I", " ", 
     RowBox[{"LegendreQ", "[", 
      RowBox[{"l", ",", "0", ",", "3", ",", 
       RowBox[{"1", "-", 
        RowBox[{"2", "y"}]}]}], "]"}], 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"yp", " ", 
        RowBox[{"X1", "[", 
         RowBox[{"l", ",", "yp"}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"yp", " ", 
           RowBox[{"LegendreP", "[", 
            RowBox[{"l", ",", "0", ",", "3", ",", 
             RowBox[{"1", "-", 
              RowBox[{"2", "yp"}]}]}], "]"}]}], ",", "yp"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"yp", ",", "1", ",", "y"}], "}"}]}], "]"}]}], "-", 
    RowBox[{"4", "I", " ", 
     RowBox[{"LegendreP", "[", 
      RowBox[{"l", ",", "0", ",", "3", ",", 
       RowBox[{"1", "-", 
        RowBox[{"2", "y"}]}]}], "]"}], 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"yp", " ", 
        RowBox[{"X1", "[", 
         RowBox[{"l", ",", "yp"}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"yp", " ", 
           RowBox[{"LegendreQ", "[", 
            RowBox[{"l", ",", "0", ",", "3", ",", 
             RowBox[{"1", "-", 
              RowBox[{"2", "yp"}]}]}], "]"}]}], ",", "yp"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"yp", ",", "1", ",", "y"}], "}"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"X2alt", "[", 
    RowBox[{"l_", ",", "y_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "4"}], "I", " ", 
     RowBox[{"LegendreQ", "[", 
      RowBox[{"l", ",", "0", ",", "3", ",", 
       RowBox[{"1", "-", 
        RowBox[{"2", "y"}]}]}], "]"}], 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"yp", " ", 
        RowBox[{"LegendreP", "[", 
         RowBox[{"l", ",", "0", ",", "3", ",", 
          RowBox[{"1", "-", 
           RowBox[{"2", "yp"}]}]}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"yp", " ", 
           RowBox[{"X1", "[", 
            RowBox[{"l", ",", "yp"}], "]"}]}], ",", "yp"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"yp", ",", "1", ",", "y"}], "}"}]}], "]"}]}], "+", 
    RowBox[{"4", "I", " ", 
     RowBox[{"LegendreP", "[", 
      RowBox[{"l", ",", "0", ",", "3", ",", 
       RowBox[{"1", "-", 
        RowBox[{"2", "y"}]}]}], "]"}], 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"yp", " ", 
        RowBox[{"LegendreQ", "[", 
         RowBox[{"l", ",", "0", ",", "3", ",", 
          RowBox[{"1", "-", 
           RowBox[{"2", "yp"}]}]}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"yp", " ", 
           RowBox[{"X1", "[", 
            RowBox[{"l", ",", "yp"}], "]"}]}], ",", "yp"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"yp", ",", "1", ",", "y"}], "}"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X2", "[", 
   RowBox[{"2", ",", "1.2"}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X2alt", "[", 
   RowBox[{"2", ",", "1.2"}], "]"}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.73434963530274*^9, 3.734349797962701*^9}, {
  3.734349842700336*^9, 3.734349846275546*^9}, {3.7343509322445583`*^9, 
  3.734350963243327*^9}, {3.7343517420223513`*^9, 3.7343518429613447`*^9}, {
  3.734351881197362*^9, 3.73435194618469*^9}, {3.7344627929513197`*^9, 
  3.7344628186503077`*^9}, {3.7344628537973127`*^9, 3.734462882553817*^9}, {
  3.7347200709675407`*^9, 3.734720072204652*^9}, {3.73472041602269*^9, 
  3.734720465980134*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "9.104815733946293`"}], "+", 
  RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{
  3.734717202789382*^9, 3.734720077196207*^9, {3.7347204206025667`*^9, 
   3.7347204680879593`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "9.104815733946323`"}], "+", 
  RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{
  3.734717202789382*^9, 3.734720077196207*^9, {3.7347204206025667`*^9, 
   3.7347204700469313`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nmax", "=", "3"}], ";", 
  RowBox[{"rmax", "=", "30"}], ";", 
  RowBox[{"smax", "=", "3"}], ";", 
  RowBox[{"tmax", "=", "30"}], ";", 
  RowBox[{"l", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", 
       RowBox[{"nmax", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", 
       RowBox[{"-", "rmax"}], ",", "rmax"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "0", ",", 
       RowBox[{"smax", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", ";;", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "l"], 
      RowBox[{"pp", "[", 
       RowBox[{"l", ",", "r"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", "0", ",", 
       RowBox[{"rmax", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", ";;", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"I", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "l"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", 
              RowBox[{"\[Sigma]", "[", "l", "]"}]}]}], ")"}], 
           RowBox[{"pp", "[", 
            RowBox[{"l", ",", 
             RowBox[{"l", "-", "r", "+", "1"}]}], "]"}]}], "-", 
          RowBox[{"pp", "[", 
           RowBox[{"l", ",", 
            RowBox[{"l", "-", "r"}]}], "]"}], "+", 
          RowBox[{"2", 
           RowBox[{"qp", "[", 
            RowBox[{"l", ",", 
             RowBox[{"r", "-", 
              RowBox[{"2", "l"}], "-", "2"}]}], "]"}]}]}], ")"}], "-", 
        RowBox[{"2", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pp", "[", 
             RowBox[{"l", ",", 
              RowBox[{"l", "-", "r", "+", "s", "+", "2"}]}], "]"}], 
            RowBox[{"qp", "[", 
             RowBox[{"0", ",", "s"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", 
             RowBox[{"Max", "[", 
              RowBox[{"0", ",", 
               RowBox[{"r", "-", "l", "-", "2"}]}], "]"}], ",", 
             RowBox[{"r", "-", "2"}]}], "}"}]}], "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", 
       RowBox[{"-", "rmax"}], ",", "rmax"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", ";;", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"I", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"l", "+", "1"}]], 
      RowBox[{"pp", "[", 
       RowBox[{"l", ",", 
        RowBox[{"l", "-", "r", "+", "1"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", 
       RowBox[{"-", "rmax"}], ",", "rmax"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B1D", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", "<", "2"}], ",", "0", ",", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"l", "-", "t", "+", "u", "+", "1"}], ")"}], 
           RowBox[{"pp", "[", 
            RowBox[{"l", ",", 
             RowBox[{"t", "-", "u"}]}], "]"}], 
           RowBox[{"A", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", 
              RowBox[{"u", "+", "1"}], ",", 
              RowBox[{"v", "+", "1"}]}], "]"}], "]"}], 
           RowBox[{"Df", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"2", "l"}], "+", "n", "-", "1"}], ",", "v", ",", "0"}], 
            "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"u", ",", "0", ",", 
            RowBox[{"rmax", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", 
            RowBox[{"u", "+", "l"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"v", ",", "0", ",", 
            RowBox[{"smax", "-", "1"}]}], "}"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"nmax", "-", "1"}]}], "}"}]}], "]"}], "//", "N"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "n", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", "3"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<``,``,``\>\"", ",", "u", ",", "t", ",", "v"}], "]"}], 
          "]"}], ";", 
         RowBox[{"Print", "[", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<``,``,``,``\>\"", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"l", "-", "t", "+", "u", "+", "1"}], ")"}], "//", "N"}],
             ",", 
            RowBox[{
             RowBox[{"pp", "[", 
              RowBox[{"l", ",", 
               RowBox[{"t", "-", "u"}]}], "]"}], "//", "N"}], ",", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", 
                RowBox[{"u", "+", "1"}], ",", 
                RowBox[{"v", "+", "1"}]}], "]"}], "]"}], "//", "N"}], ",", 
            RowBox[{
             RowBox[{"Df", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"2", "l"}], "+", "n", "-", "1"}], ",", "v", ",", 
               "0"}], "]"}], "//", "N"}]}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", "0", ",", 
          RowBox[{"rmax", "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{"u", "+", "l"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v", ",", "0", ",", 
          RowBox[{"smax", "-", "1"}]}], "}"}]}], "]"}]}]}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"C1D", "=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "<", "2"}], ",", "0", ",", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "l"}], "-", "t", "+", "u"}], ")"}], 
          RowBox[{"qp", "[", 
           RowBox[{"l", ",", 
            RowBox[{"t", "-", "u"}]}], "]"}], 
          RowBox[{"A", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", 
             RowBox[{"u", "+", "1"}], ",", 
             RowBox[{"v", "+", "1"}]}], "]"}], "]"}], 
          RowBox[{"Df", "[", 
           RowBox[{
            RowBox[{"n", "-", "1", "-", "t"}], ",", "v", ",", "0"}], "]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"u", ",", "0", ",", 
           RowBox[{"rmax", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{"tmax", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"v", ",", "0", ",", 
           RowBox[{"smax", "-", "1"}]}], "}"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", 
       RowBox[{"nmax", "-", "1"}]}], "}"}]}], "]"}], "//", 
   "N"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.734181396013713*^9, 3.734181418466455*^9}, {
   3.734181452909252*^9, 3.7341814809212427`*^9}, {3.734181529213047*^9, 
   3.734181810666366*^9}, {3.734181879361382*^9, 3.734181885536928*^9}, {
   3.734181955580337*^9, 3.734182016221758*^9}, {3.73418270452496*^9, 
   3.734182724822246*^9}, {3.734182785487862*^9, 3.7341828012724857`*^9}, {
   3.7341828546507483`*^9, 3.7341828619984407`*^9}, {3.734182980834309*^9, 
   3.7341829813182173`*^9}, {3.7342706926463337`*^9, 3.734270726073566*^9}, {
   3.734270816743113*^9, 3.734270823482252*^9}, {3.734272252340819*^9, 
   3.734272424595068*^9}, {3.734272528436475*^9, 3.73427269285349*^9}, {
   3.734272834611409*^9, 3.734272940237831*^9}, {3.734273077303165*^9, 
   3.734273094527185*^9}, {3.7342731312054777`*^9, 3.73427315952274*^9}, {
   3.7342739344575653`*^9, 3.734273972633025*^9}, {3.734274002912745*^9, 
   3.73427400303345*^9}, {3.734274212199842*^9, 3.734274216264743*^9}, {
   3.7342742764045773`*^9, 3.7342742813574743`*^9}, {3.734274363186915*^9, 
   3.734274365331407*^9}, {3.734274445461753*^9, 3.7342746492720413`*^9}, {
   3.7342746897914877`*^9, 3.734274734364358*^9}, {3.734274777232333*^9, 
   3.7342748601109962`*^9}, {3.734274912379801*^9, 3.734274930311034*^9}, {
   3.734275006593054*^9, 3.734275006941022*^9}, {3.734275051375636*^9, 
   3.73427509384696*^9}, {3.734275167542556*^9, 3.734275215131918*^9}, {
   3.734275545561103*^9, 3.734275775853765*^9}, {3.734276027786037*^9, 
   3.734276160572055*^9}, {3.734276218300043*^9, 3.734276299123815*^9}, {
   3.734276333565529*^9, 3.73427634864174*^9}, {3.7342768067910967`*^9, 
   3.7342768278139677`*^9}, {3.7342769734402933`*^9, 3.734276981796104*^9}, {
   3.734277012150364*^9, 3.734277030778028*^9}, {3.734277100662395*^9, 
   3.73427714424852*^9}, {3.734277178408342*^9, 3.734277206394346*^9}, {
   3.7342772634485903`*^9, 3.7342772936539497`*^9}, 3.7342773657861853`*^9, {
   3.734277467238863*^9, 3.73427749704528*^9}, {3.734279470731307*^9, 
   3.734279489849943*^9}, {3.7342795468192997`*^9, 3.734279557747238*^9}, {
   3.734279774433715*^9, 3.734279789194049*^9}, {3.734349626782937*^9, 
   3.734349627703195*^9}, {3.734354509602315*^9, 3.7343545096827393`*^9}, {
   3.734354542093657*^9, 3.734354568323802*^9}, {3.734356270532048*^9, 
   3.7343562941545897`*^9}, {3.734356326935486*^9, 3.734356327351636*^9}, {
   3.734365570809181*^9, 3.734365571631283*^9}, {3.7343656124766417`*^9, 
   3.734365613209261*^9}, {3.7343656888144493`*^9, 3.7343657295125837`*^9}, {
   3.7343659134020157`*^9, 3.734365921143525*^9}, {3.734365963819545*^9, 
   3.7343660575419827`*^9}, 3.734366134148982*^9, {3.7343663287791367`*^9, 
   3.734366339538569*^9}, {3.734366943585025*^9, 3.7343669698704557`*^9}, {
   3.73436700183654*^9, 3.734367145710188*^9}, {3.734367214303486*^9, 
   3.7343672479100637`*^9}, {3.7343729946331997`*^9, 3.734373017533224*^9}, {
   3.734373050514456*^9, 3.734373063683758*^9}, {3.734373132988531*^9, 
   3.734373143979958*^9}, {3.734373219844614*^9, 3.7343732397879343`*^9}, {
   3.734373425177849*^9, 3.734373432555072*^9}, {3.734373469247121*^9, 
   3.7343735291518507`*^9}, {3.734373612587016*^9, 3.734373641318762*^9}, {
   3.734373675858728*^9, 3.7343736769776363`*^9}, {3.7343737598843727`*^9, 
   3.734373780604466*^9}, {3.734373812237858*^9, 3.734374056633613*^9}, 
   3.734374124790337*^9, {3.734428716238625*^9, 3.734428719327388*^9}, {
   3.7344298358261633`*^9, 3.734429843290082*^9}, {3.734718951566516*^9, 
   3.73471899889475*^9}, {3.734719033199204*^9, 3.734719207562801*^9}, {
   3.734719300484239*^9, 3.734719367988366*^9}, {3.734719409312183*^9, 
   3.734719438309301*^9}, {3.734719521593278*^9, 3.7347195723027163`*^9}, {
   3.734719604751544*^9, 3.7347196502549753`*^9}, {3.7347196804989147`*^9, 
   3.734719697236135*^9}, {3.734719734711793*^9, 3.734719741269014*^9}, {
   3.734719860886036*^9, 3.734720003560904*^9}, {3.734720036718102*^9, 
   3.734720059505319*^9}, {3.734720930424399*^9, 3.734720964309824*^9}, 
   3.73472106281887*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.734718971164611*^9, 3.7347189990913897`*^9}, 
   3.7347192098491373`*^9, {3.7347193051045732`*^9, 3.7347193782285423`*^9}, {
   3.734719410256242*^9, 3.7347194388286343`*^9}, {3.734719523390576*^9, 
   3.734719572874345*^9}, {3.7347196097548723`*^9, 3.73471961753205*^9}, 
   3.734719650645918*^9, {3.734719690891368*^9, 3.734719697959573*^9}, {
   3.734719734941983*^9, 3.734719741666954*^9}, {3.734719894041054*^9, 
   3.734720004102023*^9}, {3.734720039047509*^9, 3.73472005965847*^9}, {
   3.734720933085957*^9, 3.734720964507564*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.734718971164611*^9, 3.7347189990913897`*^9}, 
   3.7347192098491373`*^9, {3.7347193051045732`*^9, 3.7347193782285423`*^9}, {
   3.734719410256242*^9, 3.7347194388286343`*^9}, {3.734719523390576*^9, 
   3.734719572874345*^9}, {3.7347196097548723`*^9, 3.73471961753205*^9}, 
   3.734719650645918*^9, {3.734719690891368*^9, 3.734719697959573*^9}, {
   3.734719734941983*^9, 3.734719741666954*^9}, {3.734719894041054*^9, 
   3.734720004102023*^9}, {3.734720039047509*^9, 3.73472005965847*^9}, {
   3.734720933085957*^9, 3.734720964584713*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "n", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", "2"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<``,``,``\>\"", ",", "u", ",", "t", ",", "v"}], "]"}], 
          "]"}], ";", 
         RowBox[{"Print", "[", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<``,``,``,``\>\"", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "l"}], "-", "t", "+", "u"}], ")"}], "//", "N"}], 
            ",", 
            RowBox[{
             RowBox[{"qp", "[", 
              RowBox[{"l", ",", 
               RowBox[{"t", "-", "u"}]}], "]"}], "//", "N"}], ",", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", 
                RowBox[{"u", "+", "1"}], ",", 
                RowBox[{"v", "+", "1"}]}], "]"}], "]"}], "//", "N"}], ",", 
            RowBox[{
             RowBox[{"Df", "[", 
              RowBox[{
               RowBox[{"n", "-", "1", "-", "t"}], ",", "v", ",", "0"}], "]"}],
              "//", "N"}]}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{"tmax", "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", "0", ",", 
          RowBox[{"rmax", "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v", ",", "0", ",", 
          RowBox[{"smax", "-", "1"}]}], "}"}]}], "]"}]}]}], "]"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"B3D", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "<", "2"}], ",", "0", ",", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"l", "-", "t", "+", "u", "+", "1"}], ")"}], 
             RowBox[{"pp", "[", 
              RowBox[{"l", ",", 
               RowBox[{"t", "-", "u"}]}], "]"}], 
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", 
                RowBox[{"u", "+", "1"}], ",", 
                RowBox[{"v", "+", "1"}]}], "]"}], "]"}], 
             RowBox[{"Df", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"2", "l"}], "+", "n", "-", "t"}], ",", "v", ",", 
               "s"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"u", ",", "0", ",", 
              RowBox[{"rmax", "-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", "0", ",", 
              RowBox[{"smax", "-", "1"}]}], "}"}]}], "]"}], "-", 
          RowBox[{
           RowBox[{"KroneckerDelta", "[", 
            RowBox[{"s", ",", "0"}], "]"}], 
           RowBox[{"KroneckerDelta", "[", 
            RowBox[{"t", ",", 
             RowBox[{
              RowBox[{"2", "l"}], "+", "n", "+", "1"}]}], "]"}], 
           RowBox[{"B1D", "[", 
            RowBox[{"[", 
             RowBox[{"n", "+", "1"}], "]"}], "]"}]}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "0", ",", 
         RowBox[{"nmax", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", 
         RowBox[{"rmax", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "0", ",", 
         RowBox[{"smax", "-", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C3D", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "<", "2"}], ",", "0", ",", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "l"}], "-", "t", "+", "u"}], ")"}], 
             RowBox[{"qp", "[", 
              RowBox[{"l", ",", 
               RowBox[{"t", "-", "u"}]}], "]"}], 
             RowBox[{"A", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", 
                RowBox[{"u", "+", "1"}], ",", 
                RowBox[{"v", "+", "1"}]}], "]"}], "]"}], 
             RowBox[{"Df", "[", 
              RowBox[{
               RowBox[{"n", "-", "1", "-", "t"}], ",", "v", ",", "s"}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"u", ",", "0", ",", 
              RowBox[{"rmax", "-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", "0", ",", 
              RowBox[{"smax", "-", "1"}]}], "}"}]}], "]"}], "-", 
          RowBox[{
           RowBox[{"KroneckerDelta", "[", 
            RowBox[{"s", ",", "0"}], "]"}], 
           RowBox[{"KroneckerDelta", "[", 
            RowBox[{"t", ",", "n"}], "]"}], 
           RowBox[{"C1D", "[", 
            RowBox[{"[", 
             RowBox[{"n", "+", "1"}], "]"}], "]"}]}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "0", ",", 
         RowBox[{"nmax", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", 
         RowBox[{"rmax", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "0", ",", 
         RowBox[{"smax", "-", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"4", "I", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"qp", "[", 
             RowBox[{"l", ",", 
              RowBox[{"r", "-", "t"}]}], "]"}], 
            RowBox[{"B3D", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"n", "+", "1"}], ",", 
               RowBox[{"t", "+", "1"}], ",", 
               RowBox[{"s", "+", "1"}]}], "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"pp", "[", 
             RowBox[{"l", ",", 
              RowBox[{"r", "-", "t"}]}], "]"}], 
            RowBox[{"C3D", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"n", "+", "1"}], ",", 
               RowBox[{"t", "+", "1"}], ",", 
               RowBox[{"s", "+", "1"}]}], "]"}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "r"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "0", ",", 
         RowBox[{"nmax", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", "0", ",", 
         RowBox[{"rmax", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "0", ",", 
         RowBox[{"smax", "-", "1"}]}], "}"}]}], "]"}], "//", "N"}], "//", 
    "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.734719338270893*^9, 3.7347193391942253`*^9}, 
   3.734720925111911*^9}]
},
WindowSize->{1315, 1455},
WindowMargins->{{Automatic, 372}, {Automatic, 18}},
Magnification:>2. Inherited,
FrontEndVersion->"10.0 for Linux x86 (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 238, 5, 101, "Input"],
Cell[799, 27, 7130, 221, 978, "Input"],
Cell[CellGroupData[{
Cell[7954, 252, 1201, 24, 207, "Input"],
Cell[9158, 278, 252, 4, 89, "Output"],
Cell[9413, 284, 341, 6, 89, "Output"],
Cell[9757, 292, 341, 6, 89, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10135, 303, 3690, 103, 597, "Input"],
Cell[13828, 408, 243, 6, 89, "Output"],
Cell[14074, 416, 243, 6, 89, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14354, 427, 11684, 284, 1166, "Input"],
Cell[26041, 713, 651, 10, 89, "Output"],
Cell[26695, 725, 651, 10, 89, "Output"]
}, Open  ]],
Cell[27361, 738, 7338, 197, 1661, "Input"]
}
]
*)

(* End of internal cache information *)
